{
  "type": "class_code",
  "class_name": "SIMPLE_CHART",
  "code": "note\n\tdescription: \"Main facade for charting. Loads CSV data and renders charts.\"\n\tauthor: \"Generated by simple_codegen\"\n\tdate: \"2026-01-16\"\n\nclass\n\tSIMPLE_CHART\n\ncreate\n\tmake\n\nfeature {NONE} -- Initialization\n\n\tmake\n\t\t\t-- Create chart facade.\n\t\tdo\n\t\t\tcreate data_loader.make\n\t\t\tcreate bar_renderer.make\n\t\t\tcreate table_renderer.make\n\t\tensure\n\t\t\tdata_loader_created: data_loader /= Void\n\t\t\tbar_renderer_created: bar_renderer /= Void\n\t\t\ttable_renderer_created: table_renderer /= Void\n\t\tend\n\nfeature -- Access\n\n\tdata_loader: CSV_DATA_LOADER\n\t\t\t-- CSV data loader.\n\n\tbar_renderer: BAR_CHART_RENDERER\n\t\t\t-- Bar chart renderer.\n\n\ttable_renderer: TABLE_RENDERER\n\t\t\t-- Table renderer.\n\nfeature -- Status report\n\n\thas_data: BOOLEAN\n\t\t\t-- Is data loaded?\n\t\tdo\n\t\t\tResult := data_loader.has_data\n\t\tend\n\n\tlast_error: detachable STRING\n\t\t\t-- Last error message if any.\n\nfeature -- Element change\n\n\tload_csv (a_path: READABLE_STRING_GENERAL)\n\t\t\t-- Load CSV data from file at `a_path`.\n\t\trequire\n\t\t\tpath_not_empty: not a_path.is_empty\n\t\tdo\n\t\t\tlast_error := Void\n\t\t\tdata_loader.load_from_file (a_path)\n\t\t\tif not data_loader.has_data then\n\t\t\t\tlast_error := \"Failed to load CSV from file: \" + a_path.to_string_8\n\t\t\tend\n\t\tensure\n\t\t\tdata_loaded_or_error: has_data or last_error /= Void\n\t\tend\n\n\tload_csv_string (a_content: READABLE_STRING_GENERAL)\n\t\t\t-- Load CSV data from string `a_content`.\n\t\trequire\n\t\t\tcontent_not_empty: not a_content.is_empty\n\t\tdo\n\t\t\tlast_error := Void\n\t\t\tdata_loader.load_from_string (a_content)\n\t\t\tif not data_loader.has_data then\n\t\t\t\tlast_error := \"Failed to parse CSV content\"\n\t\t\tend\n\t\tensure\n\t\t\tdata_loaded_or_error: has_data or last_error /= Void\n\t\tend\n\nfeature -- Output\n\n\trender_bar_chart (a_label_column, a_value_column: INTEGER): STRING\n\t\t\t-- Render bar chart using columns for labels and values.\n\t\trequire\n\t\t\thas_data: has_data\n\t\t\tlabel_column_valid: a_label_column >= 1 and a_label_column <= data_loader.column_count\n\t\t\tvalue_column_valid: a_value_column >= 1 and a_value_column <= data_loader.column_count\n\t\tlocal\n\t\t\tl_labels: ARRAYED_LIST [STRING]\n\t\t\tl_values: ARRAYED_LIST [REAL_64]\n\t\tdo\n\t\t\tl_labels := data_loader.column_values (a_label_column)\n\t\t\tl_values := data_loader.column_as_numbers (a_value_column)\n\t\t\tbar_renderer.render (l_labels, l_values)\n\t\t\tResult := bar_renderer.as_string\n\t\tensure\n\t\t\tresult_not_empty: not Result.is_empty\n\t\tend\n\n\trender_table: STRING\n\t\t\t-- Render data as formatted ASCII table.\n\t\trequire\n\t\t\thas_data: has_data\n\t\tlocal\n\t\t\tl_headers: ARRAYED_LIST [STRING]\n\t\t\tl_rows: ARRAYED_LIST [ARRAYED_LIST [STRING]]\n\t\tdo\n\t\t\tl_headers := data_loader.headers\n\t\t\tl_rows := data_loader.all_rows\n\t\t\ttable_renderer.render (l_headers, l_rows)\n\t\t\tResult := table_renderer.as_string\n\t\tensure\n\t\t\tresult_not_empty: not Result.is_empty\n\t\tend\n\nend",
  "notes": "Facade pattern delegating to CSV_DATA_LOADER, BAR_CHART_RENDERER, and TABLE_RENDERER. Uses detachable last_error for error reporting."
}