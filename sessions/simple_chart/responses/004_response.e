{
  "type": "class_code",
  "class_name": "BAR_CHART_RENDERER",
  "code": "note\n\tdescription: \"Renders horizontal ASCII bar charts.\"\n\tauthor: \"Generated by simple_codegen\"\n\tdate: \"2026-01-16\"\n\nclass\n\tBAR_CHART_RENDERER\n\ncreate\n\tmake\n\nfeature {NONE} -- Initialization\n\n\tmake\n\t\t\t-- Create bar chart renderer.\n\t\tdo\n\t\t\tcreate output.make_empty\n\t\t\tbar_width := Default_bar_width\n\t\t\tbar_character := '#'\n\t\tensure\n\t\t\toutput_empty: output.is_empty\n\t\t\tdefault_width: bar_width = Default_bar_width\n\t\tend\n\nfeature -- Access\n\n\toutput: STRING\n\t\t\t-- Rendered output.\n\n\tas_string: STRING\n\t\t\t-- Get rendered chart as string.\n\t\tdo\n\t\t\tResult := output.twin\n\t\tensure\n\t\t\tresult_attached: Result /= Void\n\t\tend\n\nfeature -- Settings\n\n\tbar_width: INTEGER\n\t\t\t-- Maximum width of bars in characters.\n\n\tbar_character: CHARACTER\n\t\t\t-- Character used for bar fill.\n\n\tset_bar_width (a_width: INTEGER)\n\t\t\t-- Set maximum bar width.\n\t\trequire\n\t\t\twidth_positive: a_width > 0\n\t\tdo\n\t\t\tbar_width := a_width\n\t\tensure\n\t\t\twidth_set: bar_width = a_width\n\t\tend\n\n\tset_bar_character (a_char: CHARACTER)\n\t\t\t-- Set bar fill character.\n\t\tdo\n\t\t\tbar_character := a_char\n\t\tensure\n\t\t\tcharacter_set: bar_character = a_char\n\t\tend\n\nfeature -- Status report\n\n\tis_rendered: BOOLEAN\n\t\t\t-- Has a chart been rendered?\n\t\tdo\n\t\t\tResult := not output.is_empty\n\t\tend\n\nfeature -- Element change\n\n\trender (a_labels: ARRAYED_LIST [STRING]; a_values: ARRAYED_LIST [REAL_64])\n\t\t\t-- Render bar chart from labels and values.\n\t\trequire\n\t\t\tlabels_attached: a_labels /= Void\n\t\t\tvalues_attached: a_values /= Void\n\t\t\tsame_count: a_labels.count = a_values.count\n\t\tlocal\n\t\t\tl_max_value: REAL_64\n\t\t\tl_max_label_width: INTEGER\n\t\t\tl_bar_length: INTEGER\n\t\t\tl_label: STRING\n\t\t\tl_value: REAL_64\n\t\t\ti: INTEGER\n\t\tdo\n\t\t\toutput.wipe_out\n\t\t\t\n\t\t\tif a_labels.is_empty then\n\t\t\t\t-- Nothing to render\n\t\t\telse\n\t\t\t\t-- Find maximum value for scaling\n\t\t\t\tl_max_value := 0.0\n\t\t\t\tacross a_values as ic loop\n\t\t\t\t\tif ic > l_max_value then\n\t\t\t\t\t\tl_max_value := ic\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\t\n\t\t\t\t-- Find maximum label width for alignment\n\t\t\t\tl_max_label_width := 0\n\t\t\t\tacross a_labels as ic loop\n\t\t\t\t\tif ic.count > l_max_label_width then\n\t\t\t\t\t\tl_max_label_width := ic.count\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\t\n\t\t\t\t-- Render each bar\n\t\t\t\tfrom\n\t\t\t\t\ti := 1\n\t\t\t\tuntil\n\t\t\t\t\ti > a_labels.count\n\t\t\t\tloop\n\t\t\t\t\tl_label := a_labels.i_th (i)\n\t\t\t\t\tl_value := a_values.i_th (i)\n\t\t\t\t\t\n\t\t\t\t\t-- Pad label to align bars\n\t\t\t\t\toutput.append (padded_label (l_label, l_max_label_width))\n\t\t\t\t\toutput.append (\" | \")\n\t\t\t\t\t\n\t\t\t\t\t-- Calculate bar length\n\t\t\t\t\tif l_max_value > 0.0 then\n\t\t\t\t\t\tl_bar_length := (l_value / l_max_value * bar_width).truncated_to_integer\n\t\t\t\t\telse\n\t\t\t\t\t\tl_bar_length := 0\n\t\t\t\t\tend\n\t\t\t\t\t\n\t\t\t\t\t-- Render bar\n\t\t\t\t\toutput.append (bar_string (l_bar_length))\n\t\t\t\t\toutput.append (\" \")\n\t\t\t\t\toutput.append (l_value.out)\n\t\t\t\t\toutput.append_character ('%N')\n\t\t\t\t\t\n\t\t\t\t\ti := i + 1\n\t\t\t\tend\n\t\t\tend\n\t\tensure\n\t\t\trendered_if_data: not a_labels.is_empty implies is_rendered\n\t\tend\n\nfeature -- Constants\n\n\tDefault_bar_width: INTEGER = 40\n\t\t\t-- Default maximum bar width.\n\nfeature {NONE} -- Implementation\n\n\tpadded_label (a_label: STRING; a_width: INTEGER): STRING\n\t\t\t-- Label padded to `a_width` characters.\n\t\trequire\n\t\t\tlabel_attached: a_label /= Void\n\t\t\twidth_valid: a_width >= a_label.count\n\t\tlocal\n\t\t\tl_padding: INTEGER\n\t\tdo\n\t\t\tcreate Result.make (a_width)\n\t\t\tResult.append (a_label)\n\t\t\tl_padding := a_width - a_label.count\n\t\t\tfrom until l_padding = 0 loop\n\t\t\t\tResult.append_character (' ')\n\t\t\t\tl_padding := l_padding - 1\n\t\t\tend\n\t\tensure\n\t\t\tcorrect_length: Result.count = a_width\n\t\tend\n\n\tbar_string (a_length: INTEGER): STRING\n\t\t\t-- String of bar characters with given length.\n\t\trequire\n\t\t\tlength_non_negative: a_length >= 0\n\t\tlocal\n\t\t\ti: INTEGER\n\t\tdo\n\t\t\tcreate Result.make (a_length)\n\t\t\tfrom\n\t\t\t\ti := 1\n\t\t\tuntil\n\t\t\t\ti > a_length\n\t\t\tloop\n\t\t\t\tResult.append_character (bar_character)\n\t\t\t\ti := i + 1\n\t\t\tend\n\t\tensure\n\t\t\tcorrect_length: Result.count = a_length\n\t\tend\n\nend",
  "notes": "Horizontal ASCII bar chart renderer. Scales bars to max value. Supports configurable width and bar character. Labels right-padded for alignment."
}